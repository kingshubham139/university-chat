<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Chat</title>
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<style>
body{margin:0;background:#ece5dd;font-family:Arial}
.chat{max-width:500px;margin:auto;height:100vh;display:flex;flex-direction:column;background:#fff}
header{background:#075e54;color:#fff;padding:12px;text-align:center}
#msgs{flex:1;overflow:auto;padding:10px}
.msg{padding:8px;margin:6px;border-radius:8px;max-width:70%}
.me{background:#dcf8c6;margin-left:auto}
.other{background:#f1f0f0}
footer{display:flex}
input{flex:1;padding:12px}
button{padding:12px;background:#075e54;color:#fff;border:none}
</style>
</head>
<body>

<div class="chat">
<header id="h"></header>
<div id="msgs"></div>
<footer>
<input id="m" placeholder="Message">
<button onclick="send()">Send</button>
</footer>
</div>

<script>
const API="university-chat-production.up.railway.app";
const user=JSON.parse(localStorage.user);
h.innerText="Group: "+user.groupName;

const socket=io(API);
socket.emit("join",user.groupName);

socket.on("receive",d=>add(d));
socket.on("deleted",id=>{
 document.getElementById(id)?.remove();
});

function send(){
 socket.emit("send",{text:m.value,sender:user.username,groupName:user.groupName});
 m.value="";
}

function add(d){
 let div=document.createElement("div");
 div.className="msg "+(d.sender==user.username?"me":"other");
 div.id=d._id;
 div.innerHTML=d.text;
 if(d.sender==user.username)
   div.onclick=()=>socket.emit("delete",d._id);
 msgs.appendChild(div);
 msgs.scrollTop=msgs.scrollHeight;
}
</script>
</body>
</html>
